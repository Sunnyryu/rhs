# 머신러닝(세대 적성 네트워크2)

```
GAN 훈련

GAN은 별도로 훈련된 두개의 네트워크를 포함하고 있기에.. 훈련 알고리즘은 두가지 복잡성을 해결해야함.

GAN은 반드시 두가지 다른 종류의 훈련(발전기와 판별자) 조작
GAN 융합은 식별하기 어려움!

교차 훈련

발전기와 판별기는 훈련 과정이 다르다. 그렇다면 GAN 전체를 어떻게 훈련?

GAN 교육은 교차로 진행

판별자는 하나 이상의 에포치를 위해 훈련
발전기는 하나 이상의 에포치를 위해 훈련

제너레이터 및 판별기 네트워크를 계속 교육하려면 1단계와 2단계를 반복
우리는 판별자 교육 단계 동안 발전기를 일정하게 유지
판별자 교육 단계 동안 발전기를 일정하게 유지
판별자 훈련은 실제 데이터와 가짜를 구별하는 방법을 알아내려고 하기 때문에 발전기의 결함을 인식하는 방법 필요.
철저히 훈련된 발전기가 무작위 출력을 내는 훈련되지 않은 발전기와는 다른 문제..

발전기 훈련 단계 동안 판별기를 일정하게 유지
그렇지 않으면 발전기가 움직이는 목표물을 치려고 할 것이고 절대 수렴하지 않을 것

초기 무작위 발생기 출력에도 실제 데이터와 생성된 데이터의 차이를 구분하는 분류기를 훈련할 수 없다면 GAN 훈련을 시작 어려움!

수렴? 융합?

발전기가 훈련을 받으면 발전기가 좋아질수록 판별기가 실제와 가짜의 차이를 쉽게 구분하지 못하기 때문에 판별기 성능은 나빠짐.

발전기가 완벽하게 성공하면 판별기는 50%의 정확도를 갖는다. 실제로 판별자는 동전을 던져 예측
GAN 전체의 수렴에 문제를 제기

판별자 피드백은 시간이 지남에 따라 덜 의미 있게 됌.
GAN이 판별자가 완전히 무작위 피드백을 주는 시점을 지나 훈련을 계속한다면, 발전기는 정크 피드백을 통해 훈련을 받기 시작하고, 그 자체의 품질은 붕괴될 수 있음
```

```
손실 함수

GANs는 확률 분포를 복제하려고 시도

GAN에서 생성된 데이터의 분포와 실제 데이터의 분포 사이의 거리를 반영하는 손실 함수를 사용해야함.
GAN 손실 함수에서 두 분포 간의 차이를 어떻게 포착?

텐서플로에서도 GAN을 사용가능!

최소 손실: GANs를 소개한 논문에서 사용된 손실 함수
와서스테인 손실: TF-GAN Estimator의 기본 손실 함수

1개 또는 2개의 손실 기능
GAN은 발전기 훈련용과 판별기 훈련용 두 가지 손실 기능을 가질 수 있음.

손실 계획(스키마)에서 발생기와 판별기 손실은 확률 분포 사이의 거리에 대한 단일 측정치에서 도출
즉 가짜 데이터의 분포를 반영하는 용어에만 영향을 미칠 수 있음.
발전기 훈련 중에 우리는 실제 데이터의 분포를 반영하는 다른 용어를 삭제
발전기와 판별기 손실은 하나의 공식에서 도출되더라도 결국 다르게 보임

최소최대 손실

발전기는 일부 기능을 최소화하려고 하지만 판별자는 이를 최대화하려고 함! (구글 문서 참조)

수정된 최소최대손실 

GAN 논문은 위의 미니맥스 손실 기능이 판별자의 업무가 매우 쉬울 때 GAN 훈련의 초기 단계에 GAN을 고착시킬 수 있다는 점에 주목
발전기가 로그(log) D(G(z))를 최대화하도록 발전기 손실을 수정할 것! (D(G(z))는 가짜 인스턴스가 진짜일 확률을 판별자가 추정하는 것)
```

```
와서스테인 손실 (TF-GAN은 Wasserstein 손실을 사용)

손실 함수는 판별자가 실제로 인스턴스를 분류하지 않는 GAN 체계의 변경에 따라 달라짐.
각 인스턴스에 대해 숫자를 출력
이 숫자는 1보다 작거나 0보다 클 필요는 없으므로, 인스턴스가 진짜인지 가짜인지를 결정하기 위한 임계값으로 0.5를 사용할 수는 없음.
판별자 훈련은 가짜 사례보다 실제 사례를 위해 출력을 더 크게 만들려고 할 뿐

진짜와 가짜를 구분할 수 없기 때문에 WGAN(GAN체계) 판별자는 사실상 '비평가'가 아닌 '판별장치'로 불림. 
목적상 손실 함수에 대한 입력은 확률일 필요가 없다는 것을 인정하는 것으로 취급할 수 있음.

비평가 손실: D(x) - D(G(z))
판별자는 이 기능을 최대화하려고 함. (제 사례에서의 생산량과 가짜 사례에서의 생산량의 차이를 최대화하려고 함.)

제너레이터 손실: D(G(z))

발전기는 이 기능을 최대화하려고함. (가짜 사례에 대해 판별자의 산출량을 극대화하려고 함.)

D(x)는 비평가들의 실례를 들어 산출!
G(z)는 노이즈 z가 주어졌을 때 제너레이터의 출력!
D(G(z))는 비평가들의 가짜 예에 대한 산출물!
비평가 D의 산출물은 반드시 1과 0 사이일 필요는 없음!
공식은 실제 분포와 생성된 분포 사이의 지구 이동 거리에서 도출!

와세슈타인 GAN은 미니맥스 기반 GAN보다 고착에 덜 취약
```

```
식별자 네트워크 및 제너레이터 네트워크 영향 생성기와 라벨에 의해 생성되는 데이터를 통해서만 서로 식별자에 의해 생성 역추진에 관한 한, 그들은 별개의 네트워크
(거짓 - 발전기 훈련 중에 구배는 전파를 통해 전달 / 식별자 네트워크는 발전기 네트워크의 업데이트 영향을 미침! )

GAN은 발전기와 판별기를 교차로 훈련시킴! 
GAN은 항상 판별기와 발전기 훈련에 동일한 손실 기능을 사용 -> GAN이 발전기와 판별기 훈련(신호에서만 다른 동일한 손실)에 대해 동일한 손실을 사용할 수 있지만 필요치 않음! -> 다른 손실을 쓰는 게 더 바람직함!
```