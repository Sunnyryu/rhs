# 머신러닝(샘플링 / 스플리팅 데이터)

```
궁극적으로 답은 문제에 달려있다: 우리는 무엇을 예측하고 싶은가, 그리고 어떤 특징을 원하는가?

이전 쿼리를 사용하려면 세션에 쿼리 시퀀스가 포함되어 있으므로 세션 수준에서 샘플링해야 한다.
이전 날짜의 피쳐 사용자 동작을 사용하려면 사용자 수준에서 샘플을 채취해야 한다.

PII(개인 식별 가능 정보) 필터링

데이터에 PII(개인 식별 가능 정보)가 포함되어 있는 경우 데이터에서 필터링해야 할 수 있음
데이터 집합에서 PII를 필터링하고 Tail을 제거하는 과정에서 데이터 집합이 헤드 쿼리에 치우치게 된다. 프로젝트에 미치는 영향을 고려!

```

```
불균형 데이터

등급 비율이 왜곡된 분류 데이터 세트를 불균형이라고 한다. 
데이터 집합의 큰 비중을 차지하는 클래스를 다수 클래스라고 한다. 
더 적은 비율을 차지하는 사람들은 소수계급이다.

불균형한 데이터를 찾는 이유는 무엇인가? 데이터 세트가 불균형한 분류 작업이 있는 경우 특정 샘플링 기법을 적용해야 할 수 있음

균형이 맞지 않는 데이터 세트가 있는 경우 먼저 실제 분포에 대해 교육해 보십시오. 모델이 잘 작동하고 일반화하면 끝

다운샘플링 / 업웨이팅

다운샘플링은 대다수 클래스 예제의 불균형적으로 낮은 하위 집합에 대한 훈련을 의미

업웨이팅은 다운샘플링된 클래스에 다운샘플링된 인자와 동일한 예시 가중치를 추가하는 것을 의미

다수 클래스를 다운샘플링 -> 운샘플링된 클래스를 가중치 올리기 (마지막 단계는 다운샘플링된 클래스에 예시 가중치를 추가하는 것!)

가중치는 다운샘플링에 사용한 인자와 같아야함

예시가중치 = 오리지널 예시 가중치 x 다운샘플링 팩터


다운샘플과 업웨이트를 선택해야 하는 이유

보다 빠른 수렴: 훈련 중에 우리는 소수계급을 더 자주 보게 되는데, 이것은 모델이 더 빨리 수렴하는 데 도움이 될 것이다.
디스크 공간: 대다수의 클래스를 더 큰 가중치를 가진 더 적은 예제로 통합함으로써, 우리는 그것들을 저장하는 데 더 적은 디스크 공간을 소비한다. 이러한 절감은 소수 계층에게 더 많은 디스크 공간을 허용하기 때문에, 우리는 그 계층으로부터 더 많은 숫자와 더 넓은 범위의 예들을 수집할 수 있다.
보정: 업가중치는 우리의 모델이 여전히 보정되도록 보장한다. 출력은 여전히 확률로 해석될 수 있다.
```

```
데이터를 수집하고 필요한 곳에서 샘플링을 한 후 다음 단계는 데이터를 교육 세트, 검증 세트 및 테스트 세트로 나누는 것

랜덤 분할이 최선의 접근 방법일 수 있지만 항상 옳은 건 아님!

뉴스 기사들은 클러스터로 나타남. 

무작위로 데이터를 나누면 테스트 세트와 교육 세트에는 동일한 내용이 포함될 가능성이 높음!

훈련 세트와 시험 세트 교육 세트 및 테스트 세트
각각은 네 가지 모두와 다른 예들을 혼합하여 포함하고 있다

제 떄 분할하면 클러스터가 대부분 동일한 집합으로 끝나게 됌!
```

```
데이터 스플릿(분할)

순수한 무작위 분할이 항상 올바른 접근법은 아님
온라인 시스템의 빈번한 기술은 데이터를 시간별로 분할하여 다음과 같은 작업을 수행하는 것

그러나 시간 기반 분할은 수천만 개의 예를 갖춘 데이터셋과 같이 매우 큰 데이터셋에서 가장 잘 작동
모델은 예측 시간에 반드시 가질 수 없는 정보를 통해 학습

문제는 시계열 데이터로 그룹화되거나 다른 기준에 의해 클러스터링되는 등 데이터가 그룹화될 때마다 발생할 수 있다

데이터를 대표하는 분할을 설계하려면 데이터가 나타내는 것을 고려
데이터 분할에도 적용된다. 즉, 테스트 작업이 가능한 한 생산 작업과 일치해야함
```

```
무작위화(랜덤화)

데이터 생성 파이프라인을 재현 / 피처가 모델에 어떤 영향을 미치는 확인 하기 위해 피쳐 추가 / 데이터 생성 실행을 재현할 수 없는 경우 데이터 집합을 만들 수 없음

데이터 생성 시 임의 추출이 결정론적으로 이루어질 수 있는지 확인

RNG(Random Number Generator)를 시드 / 시딩은 RNG가 실행될 때마다 동일한 순서로 동일한 값을 출력하여 데이터 집합을 다시 생성하도록 한다.

불변 해시 키를 사용 / 해싱은 데이터 분할, 샘플링하는 일반적인 방법 

해싱에 대한 고려사항 (검색 쿼리 수집 / 해싱을 사용 -> 쿼리 포함 제외)
해시 키가 쿼리만 사용한 경우 여러 일 동안의 데이터에서 해당 쿼리를 항상 포함하거나 항상 제외!

당신의 평가 세트는 당신의 훈련 데이터와 중복되지 않기 때문에 인위적으로 어려울 것
```

```
항상 다수를 예측하고 있다. 어떤 기술이 이 문제를 해결하는 데 가장 도움이 될까 => 부정적인 예(다수 등급)을 다운샘플링 하고 동일한 인수로 다운 샘플링 된 클래스를 업웨이팅 시킴!

데이터 집합의 가장자리로부터 데이터를 손실하는 기술은?
PII 필터링
데이터에서 PII를 필터링하면 꼬리에 있는 정보를 제거하여 분포를 왜곡시킬 수 있다.
다운샘플링
형상 분포의 꼬리는 다운샘플링에서 정보를 잃게 된다. 

분류 문제 연구 / 무작위로 데이터 교육 평가 분할 / 무작위 분할로 인해 문제 발생 -> 취약한 데이터는?
데이터의 그룹화 / 버스트가 있는 데이터 / 연속된 시간데이터

```
