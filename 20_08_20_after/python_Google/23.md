# 머신러닝(세대 적성 네트워크)

```
GAN(Generation againstarical network) 
GAN은 생성 모델로서 교육 데이터와 유사한 새로운 데이터 인스턴스를 생성

GAN은 목표 출력을 생성하는 방법을 학습하는 제너레이터와 실제 데이터를 제너레이터의 출력과 구별하는 방법을 학습하는 판별기를 결합

"세대"는 차별적 모델과 대비되는 통계적 모델의 종류

비공식적으로
생성 모델은 새로운 데이터 인스턴스를 생성
차별적 모델은 다른 종류의 데이터 인스턴스를 구별
생성 모델은 실제 동물처럼 보이는 동물들의 새로운 사진을 생성하는 반면, 차별 모델은 개와 고양이를 구분할 수 있음

GAN은 생성 모델의 한종류!

일련의 데이터 인스턴스 X와 일련의 라벨 Y
생성 모델은 라벨이 없는 경우 접합 확률 p(X, Y) 또는 p(X)만 캡처
차별적 모델은 조건부 확률 p(Y | X)를 포착
생성 모델은 데이터 자체의 분포를 포함하며, 주어진 예가 얼마나 가능성이 있는지를 알려줌.
시퀀스로 예측하는 모델은 일반적으로 생성 모델 /일반적으로 GAN보다 훨씬 단순함

차별적 모델은 주어진 인스턴스(instance)가 가능성이 있는지에 대한 질문을 무시하고, 단지 인스턴스(instance)에 라벨이 적용될 가능성이 어느 정도인지 알려줌
```

```
모델링 확률

의사결정 나무와 같은 차별적 분류자는 해당 라벨에 확률을 할당하지 않고 인스턴스에 레이블을 지정할 수 있음.

예측 라벨의 분포가 데이터에 있는 라벨의 실제 분포를 모형화할 것이기 때문에 그러한 분류자는 여전히 모형일 수 있음.

생성 모델은 해당 분포에서 도출된 것처럼 보이는 설득력 있는 "가짜" 데이터를 생성함으로써 분포를 모형화있음.

생성 모델은 아날로그적 차별적 모델보다 더 하드한 것을 다룸. 생성 모델은 더 많은 모델을 모델링해야함.

차별적 모델은 데이터 공간에 경계를 긋고 생성 모델은 공간 전체에 데이터가 배치되는 방법을 모델링하려고함.

차별적 모델은 데이터 공간에 선을 그어 손으로 쓴 0과 1의 차이를 구별하려고함. 
선을 제대로 맞추면 양쪽 데이터 공간에 인스턴스가 배치되는 위치를 정확하게 모델링할 필요 없이 0과 1을 구별할 수 있음.

대조적으로 생성 모델은 데이터 공간에서 실제 상대방에 가까운 숫자를 생성하여 설득력 있는 1과 0을 생성하려고함.  (데이터공간 전체에 걸쳐 분포를 모델링함!)

GANs는 그러한 풍부한 모델을 실제 분포와 유사하게 훈련시킬 수 있는 효과적인 방법을 제공
```

```
GAN 구조 개요 
제너레이터는 타당한 데이터를 생성하는 방법을 학습 (생성된 예는 판별자에게 부정적인 훈련 예가 되연)

판별자는 발전기의 가짜 데이터와 실제 데이터를 구별하는 법을 배움. (판별자는 신뢰할 수 없는 결과를 생성한 발전기에 불이익을 줌!)

훈련시작 후 발전기는 명백히 가짜 데이터 생성 -> 판별자는 가짜라는 것을 빨리 알게됨!

훈련이 진행됨에 따라 제너레이터는 다음과 같이 판별자를 속일 수 있는 출력을 생성하는 데 더 가까워짐.

마지막으로 발전기 훈련이 잘 되면 진짜와 가짜의 차이를 구분하는 것이 더 어려워진다. 가짜 데이터를 진짜 데이터로 분류하기 시작해 정확도가 떨어짐.

발전기와 판별기 모두 신경망 / 제너레이터 출력은 판별기 입력에 직접 연결 / 판별자의 분류는 발전기가 자신의 가중치를 업데이트하는 데 사용하는 신호를 제공
```

```
판별자 
GAN의 판별자는 단순히 분류자
실제 데이터와 발전기에 의해 생성된 데이터를 구별 (분류하는 데이터 유형에 적합한 네트워크 아키텍처를 사용할 수 있음)

판별자 교육 데이터

실제 데이터 인스턴스(예: 실제 사람 사진) 판별자는 훈련 중에 이러한 사례를 긍정적인 예로 사용
생성자가 생성한 가짜 데이터 인스턴스. 판별자는 이러한 예들을 훈련 중에 부정적인 예로서 사용
판별기 훈련 중에는 발전기가 훈련하지 않음.
그것의 무게는 일정하게 유지되는 반면 그것은 차별자가 훈련할 수 있는 예를 만듬.

판별자 훈련
판별기는 두 개의 손실 기능에 연결
판별자 훈련 중 판별자는 발전기 손실을 무시하고 판별자 손실만 사용
제너레이터 훈련 중에 제너레이터 손실을 사용

판별자는 실제 데이터와 발전기의 가짜 데이터를 모두 분류함.
판별자 손실은 실제 사례를 가짜 또는 가짜 사례로 잘못 분류한 판별자에게 불이익을 줌!
판별자는 판별자 네트워크를 통해 판별자 손실로부터 역제안을 통해 가중치를 갱신

생성자 
GAN의 발전기 부분은 판별자의 피드백을 통합하여 가짜 데이터를 만드는 법을 배움 (생성기)
판별자가 자신의 산출물을 진짜로 분류하도록 만드는 법을 배움
제너레이터 훈련은 판별기 훈련이 요구하는 것보다 발전기와 판별기 사이의 보다 긴밀한 통합이 필요
(GAN에 포함..)
무작위 입력
임의 입력을 데이터 인스턴스로 변환하는 제너레이터 네트워크
생선된 데이터를 분류하는 판별기 네트워크
판별기 출력
발전기가 판별기를 속이지 못해 불이익을 주는 발전기 손실
```

```
무작위 입력
신경망은 어떤 형태의 입력을 필요로 함!
완전히 새로운 데이터 인스턴스를 출력하는 네트워크의 입력으로 사용하는 것은 무엇인가?

가장 기본적인 형태에서, GAN은 임의의 노이즈를 그것의 입력으로 받아들임..
제너레이터는 이 노이즈를 의미 있는 출력으로 변환
노이즈를 도입함으로써, 우리는 GAN이 목표 분포의 다른 장소에서 표본을 추출
다양한 데이터를 생성하도록 할 수 있음.

소음의 분포는 크게 중요하지 않기 때문에 균일한 분포처럼 샘플링하기 쉬운 것을 선택할 수 있음.
편의상 노이즈를 샘플링하는 공간은 일반적으로 출력 공간의 차원성보다 크기가 작음

일부 GAN은 비랜덤 입력을 사용하여 출력을 형성

판별기를 사용하여 제너레이터 교육

신경망을 훈련시키기 위해, 우리는 넷의 출력의 오류나 손실을 줄이기 위해 넷의 무게를 조절.
GAN에서는 발전기가 우리가 영향을 미치려고 하는 손실과 직접적으로 연결되어 있지 않음.
제너레이터가 판별기 네트에 공급되고 판별기가 우리가 영향을 미치려고 하는 출력을 생성.
발전기 손실은 판별기 네트워크가 가짜로 분류하는 샘플을 생산한 발전기에 불이익을 줌.

네트워크 덩어리는 백프로포즈에 포함되어야함.
백프로포메이션은 중량이 출력에 미치는 영향 (중량을 변경 시 출력이 어떻게 변화하는지 계산하여 각 중량을 올바른 방향으로 조정.)
발전기 중량의 영향은 그것이 공급하는 판별기 중량의 영향에 따라 달라짐.
백프로포메이션은 출력에서 시작하여 판별기를 통해 제너레이터로 다시 흐름.

발전기 훈련 중에 판별자가 바뀌는 것을 원하지 않음.
움직이는 목표물을 맞추려고 하는 것은 발전기에 더 큰 문제를 일으킴.

생성기 훈련 절차
무작위 노이즈 샘플 -> 샘플링 된 무작위 노이즈로부터 제너레이터 출력 생성 -> 제네레이터 출력에 대한 판별기(진실/거짓 분류 가져오기) -> 판별자 분류로 인한 손실 계산 -> 판별기와 제네레이터 통한 백프로포즈와 경사도 효과 얻기 -> 경사도 사용해서 발전기 중량만을 바꿈

```