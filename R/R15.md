## R

#### R Study

```
요인 분석  
    변수들의 상관성을 바탕으로 변수를 정제하여 상관관계 분석이나 회귀분석에 설명변수(독립변수)로 사용
    상관 분석  
    요인분석 과정에서 변수들이 상관관계를 분석하여 변수 간의 관련성을 분석하는데 이용
회귀 분석  
    인과관계를 분석하는데 중요한 자료를 제공

요인 분석 (Factor Analysis) 목적
    자료의 요약 : 변인을 몇 개의 공통된 변인으로 묶음
    변인 구조 파악 : 변인들의 상호관계 파악(독립성등)
    불필요한 변인 제거 : 중요도가 떨어진 변수 제거
    측정 도구 타당성 검증 : 변인들이 동일한 요인으로 묶이는지 확인  
요인 분석에 대한 활용 방안
    측정 도구가 정확히 측정했는지를 알아보기 위해서 측정 변수들이 동일한 요인으로 묶이는지를 검정한다(타당성 검정)
    변수들의 상관관계가 높은 것끼리 묶어서 변수를 정제 (변수 축소)
    변수의 중요도를 나타내는 요인적재량이 0.4 미만이면 설명력이 부족한 요인으로 판단하여 제거 (변수 제거)
    요인분석에서 얻어지는 결과를 이용하여 상관분석이나 회귀분석의 설명변수로 활용

공통요인으로 변수 정제
    특정 항목으로 묶여 지는데 사용되는 요인수 결정은 주성분 분석방법과 상관계수 행렬을 이용한 초기 고유값을 이용
    단계1] 주성분 분석 - 변동량(분산)에 영향을 주는 주요 성분을 분석하는 방법으로 요인분석에서 사용될 요인의 개수를 결정하는데 주로 이용
    단계2] 고유값으로 요인수 분석 – 고유값이란 어떤 행렬로부터 유도되는 실수값을 의미한다. 일반적으로 변화량의 (총분산)을 기준으로 요인수를 결정하는데 이용
    상관계수 행렬을 대상으로 초기 고유값 요인수 분석
    eigen()은 상관계수 행렬을 대상으로 초기 고유값과 고유벡터를 계산하는 함수
```


```R
# 공통 요인으로 변수를 정제하는 요인분석
# 6개 과목 (s1~s6)
# 점수벡터 (5점 만점, 척도:5)
s1 <- c(1, 2, 1, 2, 3, 4, 2, 3, 4, 5)  #자연과학
s2 <- c(1, 3, 1, 2, 3, 4, 2, 4, 3, 4)  # 물리화학
s3 <- c(2, 3, 2, 3, 2, 3, 5, 3, 4, 2)  #인문사회
s4 <- c(2, 4, 2, 3, 2, 3, 5, 3, 4, 1)  # 신문방송
s5 <- c(4, 5, 4, 5, 2, 1, 5, 2, 4, 3)  #응용수학
s6 <- c(4, 3, 4, 4, 2, 1, 5, 2, 4, 2)  # 추론통계
name <-1:10  #각 과목의 문제 이름


#데이터 프레임 생성
subject <- data.frame(s1, s2, s3, s4, s5, s6)
subject

#주성분 분석으로 요인수 구하기
help(prcomp)  #주성분 분석 수행 함수
pc <- prcomp(subject) # scale = TRUE
summary(pc)  # 변동량으로 볼때 주성분 요인수는 2개로 가정할 수 있습니다.
plot(pc)
```
![Deepin스크린샷_select-area_20190919172734](https://i.imgur.com/x4MgyVL.png)
```R
# 고유값으로 요인 수 분석
en <- eigen(cor(subject)) # $values : 고유값, $vectors : 고유벡터  
names(en) # "values"  "vectors"
en$values
en$vectors
en$values # $values : 고유값(스칼라) 보기
plot(en$values, type="o") # 고유값을 이용한 시각화
```
![Deepin스크린샷_select-area_20190919172900](https://i.imgur.com/I2S3lZX.png)

```R
#베리 맥스 요인 회전법
result <- factanal(subject, factors=2, rotation="varimax")
result
#p-value는 0.0232로 유의수준 0.05보다 적어서 요인수가 부족하다는 의미!

result <- factanal(subject, factors=3, rotation="varimax", scores="regression")
result

```
