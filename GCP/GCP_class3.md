## Google Cloud

#### GCP Class 3

```

Storage and Database Services~~

Strecture data -> RDBMS / nosql로 구분 되옵니다. (빅데이터에서 사용을 많이함 - Nosql)

DataWareHouse - 데이터의 창고 같은 것....  

3가지 모델을 기억 하는 것이 좋을 거같아..

지금은 이런게 있다라고 생각하면 좋을 것 같아.

Datastore -> FireStore로 바뀜..

클라우드 스토리지 !!!!!

아마존의 S3 같은 아이(오브젝트 스토리지 같은 아이!)
용량을 정해놓을 필요가 없음  
버켓의 용량은 제한이 없음 ---

늘어나는 것은 오브젝트 스토리지가 알아서 해줌!!!

오브젝트 스토리지 !!!!!!

3개의 IDC에 나눠서 저장을 함.. (오브젝트 스토리지의 버켓은 3개의 IDC에 나눠서 저장을 함)
1개가 고장나더라도 ... 나머지 IDC가 보존되어 있어서 ... 데이터를 보존할 수 있음

하나의 리전내에서 분산하여 저장하는 것은 리저널 서비스

멀티-리전=> 글로벌 서비스는 아니지만... 아시아 리전.. US리전... 등등의 리전들이 묶인 리전보다 큰 범위


스탠다드.. 오브젝트 스토리지를 쓰는 이유는 키만 억세스 키만 가지고도 사용할 수 있음... 정적인 페이지에도 쓸 수 있음 / 내가 CDN을 하나 만들었고 . 캐싱 서비스... origin data가 있어야 함.. 내가 사이트를 만들어서 이미지를 CDN에 올리고 오리진 서비스를 오브젝트 스토리지가 해줌

스탠다드/ 니어라인 /콜드라인으로 구분할 수 있음(GCP에서는 디폴트에서 선택할 수 있듬!!)

가격은 리저널 > 멀티리저널 > 스탠다드 > 니얼라인 > 콜드라인
읽을 때에는 리저널 < 멀티리저널 < 스탠다드 < 니얼라인 < 콜드라인

Durability 내구성 요소
availability SLA는 문제가 생기더라도 이어갈 수 있는 %

버켓명은 유일해야함 !!! / 버켓 안에 버켓을 포함시킬 수는 없음

버켓에 폴더를 생성을 할 수 있음

버켓에 사이즈는 제한이 없지만 .. 버켓에 들어가는 클래스(하나의 사이즈가 5TB )는 5TB의 제한이 있음
gsutil / JSON, XML API를 지원함

한 번 버켓을 만들면.. 스탠다드나 니어라인, 콜드라인으로 바꿀 수는 있음.... 멀티리전을 리전으로 바꾸거나 리전을 멀티리전으로 바꿀 수는 없음
스크립트로 만들어서 자동설정을 해서 .. 스탠다드로 했다가 콜드라인으로 돌릴 수 있음!!

어떻게 하면 뭘로 해서 어떻게 돌릴 지를 할 수 있음...

오브젝트 스토리지를 자신의 계정으로 만들고 gsutil로 확인을 했었는데..... 옆의 있는 사람이 보고 싶다고 하면 IAM rule을 가지고 access를 컨트롤 할 수 있음
구글 계정이 있어야 Cloud IAM을 사용할 수 있음 / 누구나 봐야함 .. / IAM rule은 우리가 IAM admin에서 할 수 있고 ACLs은 스토리지 오브젝트에서 직접 설정 할 수 있음 !!
구글계정에 설정 -> IAM / 오브젝트 자체에서 설정 - ACLs

signed URL -> 시간제한을 두겠다는 거임... 어떤 미디어 사이트 접속 -> 미디어사이트에 스토리지에 저장되어 있을건데, 동영상을 저장해서.. 구매를 하겠다는 사람에게 엑세스 키를 주고.. 시간제한을 줄 수 있음 (소장을 할 꺼냐, 한달을 볼꺼냐, 등의 시간 제한을 위해서)

ACLs의 기능
allUsers => 모든 유저에게 접근가능하게 할 수 있음 (퍼블릭으로 바꿈)
allAuthenticatedUsers -> 구글 계정을 가진 사람에게 설정할 수 있음

업데이트를 할 때마다 최신버전으로 저장이 되며, 과거 버전의 기록이 복제가 되어 있음!!(백업본이 저장)
데이터가 유실될 수 있는 것 방지/ 스토리지 용량은 4배가 되옵니다. (버저닝 기능)

Lifecycle 기능..

기본적으로 예를 들어보자면, 버킷이.. 스탠다드 클래스로 되어있다고 보자, 1주일이 지나면 콜드라인으로 바꾸고 6개월이 지나면 ... 지울 수 있게할 수 있음

Data import services
(트랜스퍼 서비스 / 트랜스퍼 어플라이언스)

트랜스퍼 서비스 : 트랜스퍼 서비스를 만들 수 있음 -> 버켓이 있어야함!!!(어떤 버켓에 옮겨야 하므로!!!) / 마이그레이션을 매우 중요시하고 있음 / 목적지는 다른 버켓이나, 아마존 s3 버켓, 기타 URL로 제공하는 오브젝트 들도 가능함,
EX) 아마존 같은 경우 S3 bucket / id나 키를 넣어줘야함 / 목적지 버켓!!
(대량의 데이터를 가져올 떄는 매우 오래걸림)

트랜스퍼 어플라이언스 ( 스토리지에 데이터를 담아서 구글에 전달해주면 구글이 Cloud Storage에 넣어줄 수 있음)


gcloud sql로 해줌... SQL Workbench, Toad, External applications using standard
MySQL drivers 등을 지원 해줌

마스터는 1개고 레플리카(read)만 scale out을 지원

백업 아니면 리드 레플리카라고 생각하자

처음에 나왔을 때에 클라우드 sql을 사용하면 ..... 프라이빗을 연결을 못하고 퍼블릭 연결을 했어야 했다.......... sql 서버를 퍼블릭으로 두는 사람이 어디에 있을까????
그래서... gcp에서는 퍼블릭 공간을 지원하기 위해서 클라우드 프록시를 통해 연결하는 게 있었는데..

지금은 프라이빗을 지원해줌!!!

30TB / 4000 개 이상이거나 로케이션 서비스(클라우드는 리저널이므르 ㅠㅠㅠ) 아니라면 클라우드 스패너를 사용해야한다. (가격이 너무 비싸옵니다 ㅠㅠㅠㅠ)

스패너의 경우 글로벌 서비스이며,, 가격이 비쌈

DataStore = FireStore 으로 생각할 수 있다.

앱 앤진... 문서 데이터베이스 중 하나 /

파이어스토어의 경우 2가지 모드임 // 데이터스토어 모드와 네이티 모드로 나눔 // Nosql의 문서db 같은 느낌이라고 생각하면 쉬울지도!(?)

빅테이블 - 실시간 센서를 통해 (실시간 스트리밍을 주는 것 !!)

VPN

직접 연결하면 전용선 통신 - 인터넷이 개입되어 있지 않음 ... (전용선 비용이 만만치 않음 거리와 대역폭에 따라 비용을 냄 )

라우터에 192.168.1.0/2에 가라고 설정이 되어 있고 10.1.1.0/24에서 보낸걸 받아라 라는 것을 스테틱 루트라고 함...
172.16.1.0/24가 추가 되었다면 출발점에 추가를 해야함..

만약에 라우팅를 주고 받으면 라우팅 테이블이 생성되용  (다이나믹 라우팅 프로토콜의 형태 - scale에 유형)

AS 안에서 하느냐 밖에서 하느냐에서 따라 EGP (AS 외에서 사용 EX) KT <-> SKT / IGP (AS 내에서 사용 KT <-> KT)

EGP는 BGP가 있고 IGP는 OSPF, RIP, EIG2P, IS-IS라는 것이 있음 ..
BGP, OSPF가 많이 쓰임.

AS도 사설 AS 넘버를 사용할 수 있음 (65000/ 으로 시작하는 것은 사설)

중요한 것은 클라우드에서도....
전용선이 아니고 인터넷끼리끼리 쓰는데, 공인 IP를 가지고 있으면 통신하는데 문제는 안되옵니다. 그런데 사설 IP를 쓰고 있는 상태에서 NAT 처리가 되어 있지 않으면 .. 통신을 할 수 없는데....
VPN을 쓰는 것은 암호화와 위의 경우를 예방하기 위해서 VPN을 씀!!!!

VPN을 맺기로 한다고 예를 들어보자면

A와 B가 VPN을 맺는다고 하자... (IPSec / siteto site VPN)

전용선을 쓰거나 VPN을 쓰거나 밖에 없다는거임 ㅠㅠㅠ
스태틱 라우팅을 지원하며, site-to-site VPN, 다이나믹 루트(클라우드 라우터, BGP만 지원함 => BGP는 2기종 간의 연결을 할 수 있는 AS 연결을 트래킹할 수 있으며, 많은 어트리뷰트를 가지고 하며 스케일 업을 가장 잘 처리할 수 있음), IKEv1, IKEv2 사이퍼를 지원함

보안상으로는 IKEv2를 권장하고는 있음 ...

VPN 게이트웨이를 만들 때 (VPN을 만들 때 필요한 정보, 공인 IP, 내부 네트웤, 암호화 알고리즘을 어떤 것으로 쓸 것인지를 알아야함)

VPN이 키교환을 위한 페이스 방식을 거침(암호화 방식? 페이스 2에서는 어떤 암호화 방식을 쓸꺼냐??)

GCP의 VPN GateWay는 아무거나 받아줌... 암호화 알고리즘 설정 단계가 없음 ... / So 온프리미스의 외부 ip를 알아야함.... 온프리미스의 게이트웨이는 설정을 해야하며, VPN Gateway의 인터널 ip, 익스터널 ip가 있어야함

bgp는 피어라는 말을 씀 => BGP는 TCP 통신만 가능하면 .. 연결이 가능함 .. Peer는 BGP or VPN

네트웤 변화가 많으면 다이나믹 / 적으면 스태틱 VPN

VPC 2개를 가지고 주어지는데, VPC 2개로 각각의 VPC에 VPN gataway를 만들고.. gataway 2개를 vpn peer를 맺어서 내부 ip!!!로 통신하게 하는 구조 가능 ...


ISP 간의 Peering


전용선 interconnecting (Layer3...)

gcp 와 on-p의 interconnecting

corrocation-zone의 상면에 gcp 망과 on-p 망이 연결 되어 있음

상면 서비스를 구글이 직접 할 수도 있음 (dedicate inter connectting)
구글과 연결해놓고 direct 파트너인 곳의 코로 존 상단까지 연결하면 됨 (partner inter connecting)

vpn은 캡슐화를 하기 떄문에 MTU가 커질 수 있어서 HEADER 값을 뺴고 MTU를 설정하여, 인터넷이 쪼금 느리다.

shared VPC => Organization은 같아야 함!!!

VPC peering (2개의 vpc가 external vpc를 하는데 vpc의 전용선을 연결한 것 처럼 피어링으로 제공.. )

프로젝트 단위로 빌링을하거나 쿼터를 줄 수 있음.

```
